'NOTE: DO NOT ADD REFERENCES TO COM.NETU.LIB HERE, INSTEAD ADD
'THE IMPORT ON THE REFERENCES OF THE PROJECT

Imports System.Data.Linq.Mapping

'<comments>
'Template: DBMapperBase.visualBasic.txt
'************************************************************
' Class autogenerated on 11/07/2015 12:50:33 PM by ModelGenerator
' Extends base DBMapperBase object class
' *** DO NOT change code in this class.  
'     It will be re-generated and 
'     overwritten by the code generator ****
' Instead, change code in the extender class AccountBankInfoDBMapper
'
'************************************************************
'</comments>
''
Namespace VbBusObjects.DBMappers
	<System.Runtime.InteropServices.ComVisible(False)>
	<Table(Name := "AccountInfo")> _
	<SelectObject("AccountInfo")><KeyFieldName("AccInfoId")> _
    public Class AccountBankInfoDBMapper
        Inherits DBMapper
		
#Region "Constructors "
    Public Sub New(ByVal _dbConn As DBUtils)
        MyBase.new(_dbConn)
    End Sub
        
        
    Public Sub New()
        MyBase.new()
    End Sub
#End Region

#Region "Overloaded Functions"
		
	Public Shadows Function findWhere(ByVal sWhereClause As String, _
                                        ByVal ParamArray params() As Object)  As AccountBankInfo
		
        return DirectCast(MyBase.findWhere(sWhereClause, params), AccountBankInfo)
    End Function
        

	Public Sub saveAccountBankInfo(ByVal mo As AccountBankInfo)
        MyBase.save(mo)
    End Sub
        
    Public Shadows Function findByKey(ByVal keyval As object) As AccountBankInfo

        Return DirectCast(MyBase.findByKey(keyval), AccountBankInfo)

    End Function
        
#End Region

#Region "getUpdateDBCommand"
        Public Overrides Function getUpdateDBCommand(ByVal modelObj As IModelObject, ByVal sql As String) As IDbCommand

             Dim p As IDataParameter = Nothing
             Dim obj as AccountBankInfo = DirectCast(modelObj,AccountBankInfo)
             Dim stmt As IDbCommand = Me.dbConn.getCommand(sql)
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_CONTACTNAME,obj.PrContactName))
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_CONTACTPHONE,obj.PrContactPhone))
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_CONTACTFAX,obj.PrContactFax))
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_ACCOUNTID,obj.PrAccountID))
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_SIGNEEEMPLOYEE,obj.PrSigneeEmployee))
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_COMPANYNAME,obj.PrCompanyName))
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_COMPANYBANKCODE,obj.PrCompanyBankCode))
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_BANKID,obj.PrBankId))
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_COOPCODE,obj.PrCOOPCode))
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_CREATEDATE,obj.CreateDate))
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_UPDATEDATE,obj.UpdateDate))
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_UPDATEUSER,obj.UpdateUser))
			stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_CREATEUSER,obj.CreateUser))

			If (obj.isNew) Then
			Else
			'only add primary key if we are updating and as the last parameter
				stmt.Parameters.Add(Me.dbConn.getParameter(AccountBankInfo.STR_FLD_ACCINFOID,obj.PrAccInfoId))
			End if

             return stmt

        End Function

#End Region
	public overrides sub saveParents(mo as IModelObject)

		Dim thisMo as AccountBankInfo = directCast(mo, AccountBankInfo)
		'*** Parent Association:bank
		if (thisMo.PrBank is Nothing=false) AndAlso thisMo.PrBank().NeedsSave() Then
			Dim mappervar as VbBusObjects.DBMappers.BankDBMapper= new VbBusObjects.DBMappers.BankDBMapper(me.dbConn)
			mappervar.save(thisMo.PrBank)
			thisMo.PrBankId = thisMo.PrBank.PrBANKID
		end if
		
	end sub
#Region "Find functions"

	'''	<summary>Given an sql statement, it opens a result set, and for each record returned, it creates and loads a ModelObject. </summary>
	'''	<param name="sWhereClause">where clause to be applied to "selectall" statement 
	''' that returns one or more records from the database, corresponding to the ModelObject we are going to load </param>
	'''	<param name="params"> Parameter values to be passed to sql statement </param>
	'''	<returns> A List(Of AccountBankInfo) object containing all objects loaded </returns>
	'''	 
	Public shadows Function findList(ByVal sWhereClause As String, _
										ByVal ParamArray params() As Object) _
										As List(Of AccountBankInfo)

		dim sql as String = Me.getSqlWithWhereClause(sWhereClause)
		Dim rs As IDataReader = Nothing
		Dim molist As New List(Of AccountBankInfo)
						
		Try				
			rs = dbConn.getDataReaderWithParams(sql, params)
            Me.Loader.DataSource = rs
               
			Do While rs.Read
				Dim mo As IModelObject = Me.getModelInstance
				Me.Loader.load(mo)
                molist.Add(DirectCast(mo, AccountBankInfo))
					
			Loop

				
		Finally
			Me.dbConn.closeDataReader(rs)
		End Try

		Return molist

	End Function
    
	Public Shadows Function findList(ByVal sWhereClause As String, _
        ByVal params As List(Of IDataParameter)) _
        As List(Of AccountBankInfo)

        Dim sql As String = Me.getSqlWithWhereClause(sWhereClause)
        Dim rs As IDataReader = Nothing
        Dim molist As New List(Of AccountBankInfo)

        Try
            rs = dbConn.getDataReader(sql, params)
            Me.Loader.DataSource = rs

            Do While rs.Read
                Dim mo As IModelObject = Me.getModelInstance
                Me.Loader.load(mo)
                molist.Add(DirectCast(mo, AccountBankInfo))

            Loop


        Finally
            Me.dbConn.closeDataReader(rs)
        End Try

        Return molist

    End Function

	'''    
	'''	 <summary>Returns all records from database for a coresponding ModelObject </summary>
	''' <returns>List(Of AccountBankInfo) </returns>
	Public Function findAll() As List(Of AccountBankInfo)
		Return Me.findList(String.Empty)
	End Function
		
	public Overrides Property Loader() As IModelObjectLoader
		Get
			if me._loader is Nothing then 
				me._loader = New AccountBankInfoDataReaderLoader
			end If
			return me._loader
        End Get
        Set(value as IModelObjectLoader)
			me._loader = value
        end Set
    End Property

#End Region
		
	Public Overrides Function getModelInstance() As IModelObject
		return new AccountBankInfo()
    End Function
		
End Class

#Region " AccountBankInfo Loader "
	<System.Runtime.InteropServices.ComVisible(False)> _
	Public Class AccountBankInfoDataReaderLoader
		Inherits DataReaderLoader

			Public Overrides sub load(ByVal mo As IModelObject)

			Const DATAREADER_FLD_ACCINFOID as Integer = 0
			Const DATAREADER_FLD_CONTACTNAME as Integer = 1
			Const DATAREADER_FLD_CONTACTPHONE as Integer = 2
			Const DATAREADER_FLD_CONTACTFAX as Integer = 3
			Const DATAREADER_FLD_ACCOUNTID as Integer = 4
			Const DATAREADER_FLD_SIGNEEEMPLOYEE as Integer = 5
			Const DATAREADER_FLD_COMPANYNAME as Integer = 6
			Const DATAREADER_FLD_COMPANYBANKCODE as Integer = 7
			Const DATAREADER_FLD_BANKID as Integer = 8
			Const DATAREADER_FLD_COOPCODE as Integer = 9
			Const DATAREADER_FLD_CREATEDATE as Integer = 10
			Const DATAREADER_FLD_UPDATEDATE as Integer = 11
			Const DATAREADER_FLD_UPDATEUSER as Integer = 12
			Const DATAREADER_FLD_CREATEUSER as Integer = 13

			
            Dim obj As AccountBankInfo = directCast(mo, AccountBankInfo)
            obj.IsObjectLoading = True

			if me.reader.IsDBNull(DATAREADER_FLD_ACCINFOID) = false Then
				obj.PrAccInfoId = Convert.ToInt64(me.reader.GetInt32(DATAREADER_FLD_ACCINFOID))
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_CONTACTNAME) = false Then
				obj.PrContactName = me.reader.GetString(DATAREADER_FLD_CONTACTNAME)
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_CONTACTPHONE) = false Then
				obj.PrContactPhone = me.reader.GetString(DATAREADER_FLD_CONTACTPHONE)
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_CONTACTFAX) = false Then
				obj.PrContactFax = me.reader.GetString(DATAREADER_FLD_CONTACTFAX)
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_ACCOUNTID) = false Then
				obj.PrAccountID = Convert.ToInt64(me.reader.GetInt32(DATAREADER_FLD_ACCOUNTID))
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_SIGNEEEMPLOYEE) = false Then
				obj.PrSigneeEmployee = me.reader.GetString(DATAREADER_FLD_SIGNEEEMPLOYEE)
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_COMPANYNAME) = false Then
				obj.PrCompanyName = me.reader.GetString(DATAREADER_FLD_COMPANYNAME)
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_COMPANYBANKCODE) = false Then
				obj.PrCompanyBankCode = me.reader.GetString(DATAREADER_FLD_COMPANYBANKCODE)
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_BANKID) = false Then
				obj.PrBankId = Convert.ToInt64(me.reader.GetInt32(DATAREADER_FLD_BANKID))
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_COOPCODE) = false Then
				obj.PrCOOPCode = me.reader.GetString(DATAREADER_FLD_COOPCODE)
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_CREATEDATE) = false Then
				obj.CreateDate = me.reader.GetDateTime(DATAREADER_FLD_CREATEDATE)
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_UPDATEDATE) = false Then
				obj.UpdateDate = me.reader.GetDateTime(DATAREADER_FLD_UPDATEDATE)
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_UPDATEUSER) = false Then
				obj.UpdateUser = me.reader.GetString(DATAREADER_FLD_UPDATEUSER)
			End if
			if me.reader.IsDBNull(DATAREADER_FLD_CREATEUSER) = false Then
				obj.CreateUser = me.reader.GetString(DATAREADER_FLD_CREATEUSER)
			End if

            
            obj.isNew = false ' since we've just loaded from database, we mark as "old"
            obj.isDirty = False
			obj.IsObjectLoading = False
			obj.afterLoad()

            return
            
        End sub
	
	End Class

#End Region
		
	'''<summary>
    ''' Final Class with convinience shared methods for loading/saving the EmployeeRank ModelObject. 
    '''</summary>
	<System.Runtime.InteropServices.ComVisible(False)> _
	Public NotInheritable Class AccountBankInfoDataUtils

#Region "Shared ""get"" Functions "

		Public Shared Function findList(ByVal where As String, ByVal ParamArray params() As Object) _
					As List(Of AccountBankInfo)

            dim dbm as AccountBankInfoDBMapper = new AccountBankInfoDBMapper()
            Return dbm.findList(where, params)

        End Function
		
		Public Shared Function findList(ByVal where As String, ByVal params As List(Of IDataParameter)) _
										As List(Of AccountBankInfo)

            Dim dbm As AccountBankInfoDBMapper = New AccountBankInfoDBMapper()
            Return dbm.findList(where, params)

        End Function

		Public Shared Function findOne(ByVal where As String, ByVal ParamArray params() As Object) _
					As AccountBankInfo

            Dim dbm As AccountBankInfoDBMapper = New AccountBankInfoDBMapper()
            Return DirectCast(dbm.findWhere(where, params), AccountBankInfo)

        End Function
        
        
         Public Shared Function findList() As List(Of AccountBankInfo)
			
			return new AccountBankInfoDBMapper().findAll()
			
        End Function
        
        Public Shared Function findByKey(id as object) as AccountBankInfo
			
			return DirectCast( new AccountBankInfoDBMapper().findByKey(id),AccountBankInfo)
                        
        end function
        
		''' <summary>
        ''' Reload the AccountBankInfo from the database
        ''' </summary>
        ''' <remarks>
		''' use this method when you want to relad the AccountBankInfo 
		''' from the database, discarding any changes
		''' </remarks>
		Public Shared Sub reload(ByRef mo As AccountBankInfo)
			
			If mo Is Nothing Then
                Throw New System.ArgumentNullException("null object past to reload function")
            End If
            
			mo = DirectCast(New AccountBankInfoDBMapper().findByKey(mo.Id), AccountBankInfo)
            
        End Sub

#End Region

#Region "Shared Save and Delete Functions"
		''' <summary>
        ''' Convinience method to save a AccountBankInfo Object.
        ''' Important note: DO NOT CALL THIS IN A LOOP!
        ''' </summary>
        ''' <param name="AccountBankInfoObj"></param>
        ''' <remarks>
		''' Important note: DO NOT CALL THIS IN A LOOP!  
		''' This method simply instantiates a AccountBankInfoDBMapper and calls the save method
		''' </remarks>
		public shared sub saveAccountBankInfo(ByVal ParamArray AccountBankInfoObj() As AccountBankInfo)
            
            dim dbm as AccountBankInfoDBMapper = new AccountBankInfoDBMapper()
            dbm.saveList(AccountBankInfoObj.ToList)

                       
       end sub
       

       public shared sub deleteAccountBankInfo(ByVal AccountBankInfoObj As AccountBankInfo)
            
            dim dbm as AccountBankInfoDBMapper = new AccountBankInfoDBMapper()
            dbm.delete(AccountBankInfoObj)
            
        end sub
#End Region

#Region "Data Table and data row load/save "        
        Public Shared Sub saveAccountBankInfo(ByVal dr As DataRow, _
                                                 Optional ByRef mo As AccountBankInfo = Nothing)

            if mo is Nothing then 
				mo = new AccountBankInfo()
			end if
			
            For Each dc As DataColumn In dr.Table.Columns
                mo.setAttribute(dc.ColumnName, dr.Item(dc.ColumnName))
            Next

            call saveAccountBankInfo(mo)

        End Sub
        
         
        Public Shared Sub saveAccountBankInfo(ByVal dt As DataTable, _
                                                 Optional ByRef mo As AccountBankInfo = Nothing)

            For Each dr As DataRow In dt.Rows
            	call saveAccountBankInfo(dr,mo)
            Next
			
        End Sub
        
		 Public Shared Function loadFromDataRow(ByVal r As DataRow) As AccountBankInfo

            Dim a As New DataRowLoader
            Dim mo As IModelObject = new AccountBankInfo()
            a.DataSource = r
            a.load(mo)
            Return DirectCast(mo, AccountBankInfo)

        End Function

#End Region

    End Class
	
End Namespace

